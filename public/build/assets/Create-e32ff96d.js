import{r as a,j as h,G as _,o as d,c as C,w as x,a as e,b as M,v as i,I as f,d as c,e as u,C as p,F as S,h as V,t as g,J as U,f as m}from"./app-1b79b513.js";import{_ as R}from"./AppLayout-6354d57d.js";import{_ as D}from"./Alert-916387da.js";const T=e("div",{class:"grid grid-flow-col auto-cols-auto place-content-between"},[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Create a CRM "),e("button",{class:"btn btn-primary"},"Create")],-1),L={class:"py-12 grid justify-items-center"},B={class:"p-10 w-full md:w-3/4 bg-base-200"},N={class:"card w-full bg-base-100 shadow-xl gap-4 text-center"},Q={class:"card-body w-full items-center text-center"},j=e("h2",{class:"card-title"},"What kind of CRM?",-1),F=e("option",{value:"",disabled:"",selected:""},"Select type",-1),P=e("option",{value:"default"},"IceburgCRM",-1),q=e("option",{value:"uploadschema"},"Schema Upload",-1),z=e("option",{value:"connection"},"Connect MySQL Database",-1),H=[F,P,q,z],I=e("hr",null,null,-1),$={key:0},E=e("div",{class:"alert shadow-lg mt-10 mb-10"},[e("div",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-info flex-shrink-0 w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,"Create a CRM based on the IceburgCRM framework. ")]),e("div",{class:"flex-none"},[e("a",{href:"https://www.iceburg.ca",target:"_blank",class:"btn btn-sm btn-accent text-accent-content"},"Learn More")])],-1),W=[E],Y={key:1},G=e("div",{class:"alert shadow-lg mt-10"},[e("div",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-info flex-shrink-0 w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,"Upload your own MySQL schema. Take any MySQL dump and upload it and we will create a crm from it. ")]),e("div",{class:"flex-none"},[e("a",{href:"/mysqlsampledatabase.sql",target:"_blank",class:"btn btn-sm btn-accent text-accent-content"},"Sample Schema File"),e("a",{href:"/MySQL-Sample-Database-Diagram.pdf",target:"_blank",class:"btn btn-sm btn-grey text-accent-content"},"Schema Diagram")])],-1),J=e("div",{class:"bg-base-500 mt-10 mb-10 border-primary"},null,-1),O={key:2,class:"alert shadow-lg mt-10 mb-10"},A=e("div",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"stroke-info flex-shrink-0 w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null,[m("Create a CRM from your existing MySQL database. Enter in your connection settings and we'll create a CRM using your databases as modules and database fields as CRM module fields. "),e("br"),e("br"),m("The connection information you enter will not be saved ")])],-1),K=[A],X={key:3,class:"bg-base-300 mb-10 p-10 rounded-2xl"},Z=e("h4",{class:"text-sm font-semibold mt-5"},"Connection",-1),ee={class:"grid grid-flow-col colspan-1 md:colspan-2 gap-4"},te={class:"ml-5"},se={class:"form-control max-w-xs"},ae=e("label",{class:"label"},[e("span",{class:"label-text"},"Database Name")],-1),oe={class:"form-control max-w-xs"},le=e("label",{class:"label"},[e("span",{class:"label-text"},"Host")],-1),ne={class:"form-control max-w-xs"},re=e("label",{class:"label"},[e("span",{class:"label-text"},"Username")],-1),ie={class:"form-control max-w-xs"},de=e("label",{class:"label"},[e("span",{class:"label-text"},"Password")],-1),ce={class:"form-control max-w-xs"},pe=e("label",{class:"label"},[e("span",{class:"label-text"},"Port")],-1),ue={class:"form-control max-w-xs"},me=e("label",{class:"label"},[e("span",{class:"label-text"},"Charset")],-1),_e={class:"form-control max-w-xs"},he=e("label",{class:"label"},[e("span",{class:"label-text"},"Collation")],-1),be={key:4,class:"w-full md:w-1/2 p-10 rounded-2xl bg-gray-200"},we=e("h4",{class:"text-sm font-semibold"},"Options",-1),xe={class:"form-control max-w-xs"},fe=e("label",{class:"label"},[e("span",{class:"label-text"},"Name")],-1),ge={class:"form-control max-w-xs"},ve=e("label",{class:"label"},[e("span",{class:"label-text"},"Description")],-1),ye={class:"form-control w-full max-w-xs"},ke=e("label",{class:"label"},[e("span",{class:"label-text"},"Theme")],-1),Ce=["value"],Me={key:5,class:"card card-compact w-full md:w-3/4 bg-base-100 mt-10 shadow-xl"},Se=e("div",{class:"card-body"},[e("h2",{class:"card-title place-content-center text-center"},"Default usernames and passwords"),e("p",null,[m("admin@iceburg.ca:admin"),e("br"),m(" user@iceburg.ca:user"),e("br"),m(" sales@iceburg.ca:sales"),e("br"),m(" accounting@iceburg.ca:accounting"),e("br"),m(" marketing@iceburg.ca:marketing"),e("br")])],-1),Ve=[Se],Ue={key:6,class:"card-actions"},Be={__name:"Create",setup(Re){console.log("start"),a("");const b=a();a();const w=a("Create");a(h().props.value.themes);const o=_({type:a(""),name:a(""),theme:a("light"),description:a(""),login_email:a(h().props.value.user.email),login_password:a(""),login_name:a(h().props.value.user.name)}),r=_({success_alert:a(0),error_alert:a(0),alert_text:a("")}),v=_({fields:{},row:{},show:a(!1)});a(h().props.value.connections),_({preview:a(!0)});const l=_({character_set:a("utf8mb4"),collation:a("utf8mb4_unicode_ci"),username:a(""),password:a(""),host:a(""),port:a("3306"),db_name:a(""),save_connection:a(!0),connection_id:a("")}),y=function(n){v.show=!1,console.log("in prefi");const s=n.target;s&&s.files&&(console.log("in prefi2"),b.value=s.files[0])},k=async function(){w.value="Create";const n=new FormData;o.type=="uploadschema"?n.append("input_file",b.value):o.type=="connection"&&(n.append("character_set",l.character_set),n.append("collation",l.collation),n.append("username",l.username),n.append("db_name",l.db_name),n.append("password",l.password),n.append("host",l.host),n.append("port",l.port),n.append("save_connection",l.save_connection)),n.append("login_name",o.login_name),n.append("login_email",o.login_email),n.append("login_password",o.login_password),n.append("type",o.type),n.append("name",o.name),n.append("theme",o.theme),n.append("description",o.description),console.log("in create");const s={"Content-Type":"multipart/form-data"};U.post("/create",n,{headers:s}).then(t=>{t.data&&(t.data.status==1?(r.alert_text="Your CRM has been queued for creation.  You will be forwarded to the dashboard.",r.success_alert=!0,setTimeout(()=>{window.location="/dashboard"},2e3)):(r.error_alert=1,r.alert_text=t.data.message,window.scrollTo(0,top),setTimeout(()=>{r.error_alert=null,r.alert_text=""},5e3)))}).catch(t=>{r.error_alert=1,r.alert_text=t.response.data.errors,window.scrollTo(0,top),setTimeout(()=>{r.error_alert=null,r.alert_text=""},5e3)})};return(n,s)=>(d(),C(R,{title:"Create CRM"},{header:x(()=>[T]),default:x(()=>[e("div",L,[e("div",B,[e("div",N,[M(D,{message:r.alert_text,is_successful:r.success_alert,is_error:r.error_alert},null,8,["message","is_successful","is_error"]),e("div",Q,[j,e("p",null,[i(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>o.type=t),class:"input input-bordered select-xl select w-full"},H,512),[[f,o.type]])]),I,o.type==="default"?(d(),c("div",$,W)):u("",!0),o.type==="uploadschema"?(d(),c("div",Y,[G,J,e("input",{type:"file",id:"file-input",onChange:s[1]||(s[1]=t=>y(t)),name:"file",class:"file-input file-input-primary mb-10 mt-5 w-full max-w-xs"},null,32)])):u("",!0),o.type==="connection"?(d(),c("div",O,K)):u("",!0),o.type==="connection"?(d(),c("div",X,[Z,e("div",ee,[e("div",te,[e("div",se,[ae,i(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>l.db_name=t),placeholder:"Host ip or dns address",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.db_name]])]),e("div",oe,[le,i(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>l.host=t),placeholder:"Host ip or dns address",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.host]])]),e("div",ne,[re,i(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=t=>l.username=t),placeholder:"MySQL username",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.username]])]),e("div",ie,[de,i(e("input",{type:"password","onUpdate:modelValue":s[5]||(s[5]=t=>l.password=t),class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.password]])])]),e("div",null,[e("div",ce,[pe,i(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=t=>l.port=t),placeholder:"Port Number",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.port]])]),e("div",ue,[me,i(e("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=t=>l.character_set=t),placeholder:"Character Set",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.character_set]])]),e("div",_e,[he,i(e("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=t=>l.collation=t),placeholder:"Select a name for your CRM",class:"input input-bordered w-full max-w-xs"},null,512),[[p,l.collation]])])])])])):u("",!0),o.type!=""?(d(),c("div",be,[we,e("div",xe,[fe,i(e("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=t=>o.name=t),placeholder:"Select a name for your CRM",class:"input input-bordered w-full max-w-xs"},null,512),[[p,o.name]])]),e("div",ge,[ve,i(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=t=>o.description=t),class:"textarea textarea-bordered h-24 input w-full max-w-xs",placeholder:"Set the CRM description.  Will be shown on login page"},null,512),[[p,o.description]])]),e("div",ye,[ke,i(e("select",{name:"theme","onUpdate:modelValue":s[11]||(s[11]=t=>o.theme=t),class:"select select-bordered"},[(d(!0),c(S,null,V(n.$page.props.themes,t=>(d(),c("option",{value:t.name},g(t.name),9,Ce))),256))],512),[[f,o.theme]])])])):u("",!0),o.type!=""?(d(),c("div",Me,Ve)):u("",!0),o.type!=""?(d(),c("div",Ue,[e("button",{onClick:k,class:"mt-10 btn btn-primary"},g(w.value),1)])):u("",!0)])])])])]),_:1}))}};export{Be as default};
